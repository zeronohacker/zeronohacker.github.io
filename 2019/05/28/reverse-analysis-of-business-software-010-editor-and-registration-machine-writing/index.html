<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>逆向分析商业软件 010 Editor 及注册机编写 | zeronohacker</title><meta name="keywords" content="010 Editor"><meta name="author" content="zeronohacker"><meta name="copyright" content="zeronohacker"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="010 Editor 简单介绍010 Editor 是一款非常强大的文本、十六进制编辑器，除了文本、十六进制编辑外，还包括文件解析、计算器、文件比较等功能，但它真正的强大之处还在于文件的解析功能。我们可以使用 010Editor 官方网站提供的解析脚本对 avi、bmp、png、exe 等简单格式的文件进行解析，当然也可以根据需求来自己编写文件解析脚本。但是 010 Editor 是收费的，不过官"><meta property="og:type" content="article"><meta property="og:title" content="逆向分析商业软件 010 Editor 及注册机编写"><meta property="og:url" content="https://zeronohacker.github.io/2019/05/28/reverse-analysis-of-business-software-010-editor-and-registration-machine-writing/index.html"><meta property="og:site_name" content="zeronohacker"><meta property="og:description" content="010 Editor 简单介绍010 Editor 是一款非常强大的文本、十六进制编辑器，除了文本、十六进制编辑外，还包括文件解析、计算器、文件比较等功能，但它真正的强大之处还在于文件的解析功能。我们可以使用 010Editor 官方网站提供的解析脚本对 avi、bmp、png、exe 等简单格式的文件进行解析，当然也可以根据需求来自己编写文件解析脚本。但是 010 Editor 是收费的，不过官"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://image.zeronohacker.com/top_img/2019/05/28/HTB1m_KwL9zqK1RjSZFj762lCFXaL.png"><meta property="article:published_time" content="2019-05-28T07:38:38.000Z"><meta property="article:modified_time" content="2021-09-19T08:04:00.963Z"><meta property="article:author" content="zeronohacker"><meta property="article:tag" content="010 Editor"><meta property="article:tag" content="逆向破解"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://image.zeronohacker.com/top_img/2019/05/28/HTB1m_KwL9zqK1RjSZFj762lCFXaL.png"><link rel="shortcut icon" href="https://image.zeronohacker.com/favicon.png"><link rel="canonical" href="https://zeronohacker.github.io/2019/05/28/reverse-analysis-of-business-software-010-editor-and-registration-machine-writing/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-left"},source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"逆向分析商业软件 010 Editor 及注册机编写",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-09-19 16:04:00"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));GLOBAL_CONFIG_SITE.isHome&&/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload='this.media="all"'><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="zeronohacker" type="application/atom+xml"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://image.zeronohacker.com/header.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://image.zeronohacker.com/top_img/2019/05/28/HTB1m_KwL9zqK1RjSZFj762lCFXaL.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">zeronohacker</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">逆向分析商业软件 010 Editor 及注册机编写</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-05-28T07:38:38.000Z" title="undefined 2019-05-28 15:38:38">2019-05-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C-C/">C/C++</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="逆向分析商业软件 010 Editor 及注册机编写"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/05/28/reverse-analysis-of-business-software-010-editor-and-registration-machine-writing/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2019/05/28/reverse-analysis-of-business-software-010-editor-and-registration-machine-writing/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="010-Editor-简单介绍"><a href="#010-Editor-简单介绍" class="headerlink" title="010 Editor 简单介绍"></a>010 Editor 简单介绍</h2><p><code>010 Editor</code> 是一款非常强大的文本、十六进制编辑器，除了文本、十六进制编辑外，还包括文件解析、计算器、文件比较等功能，但它真正的强大之处还在于文件的解析功能。我们可以使用 <code>010Editor</code> 官方网站提供的解析脚本对 <code>avi、bmp、png、exe</code> 等简单格式的文件进行解析，当然也可以根据需求来自己编写文件解析脚本。但是 <code>010 Editor</code> 是收费的，不过官方给出了 30 天的免费使用期限供用户体验。本文将为大家分析如何去除使用限制和编写注册机。目前最新版本为 <code>v9.0.1</code>，也是本文将分析的版本。<code>010 Editor</code> 官网：<a target="_blank" rel="noopener" href="http://www.sweetscape.com/010editor/">http://www.sweetscape.com/010editor/</a></p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1m_KwL9zqK1RjSZFj762lCFXaL.png" alt=""></p><p>2 暴力破解分析</p><p>在软件破解中，暴力破解可谓是一个最基本，也是最常见的一种手段，无非就是改跳转指令（例如 JNZ 改 JZ、JZ 改 JNZ、把跳转指令 NOP 掉等），让它跳的时候不跳，不该跳的时候跳，从而避开检测以获取它的永久使用权限。下面就列下 <code>010 Editor</code> 暴力破解的分析步骤：</p><ul><li>找到注册窗口；</li><li>测试注册窗口的反应；</li><li>根据反应做出下一步分析的打算（猜测 API、API 下断动态调试、挑出敏感字符串，在程序中搜索）；</li><li>动态分析，定位关键跳转，修改代码；</li><li>动态分析，定位关键 CALL，修改代码；</li></ul><p>在官网下载最新版本并在你的计算机上安装好后，双击让它运行起来，并点击关于，会看到 <code>Free 30-Day Trial</code> 字样，另外，注册窗口在 <code>Tools --&gt; Register</code> ，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB12XKALVzqK1RjSZFo762fcXXaD.png" alt=""></p><p>点击 <code>Check License</code> 按钮，弹出如下提示：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1qpGrL9rqK1RjSZK9760yypXaY.png" alt=""></p><p>上述意思是你输入了一个无效的用户名或者是密码，也就是说，你点击那个按钮会弹出这个提示窗口，那么我们可以从这个提示窗口入手，比如对创建这个窗口的 API 下断，或者是寻找提示信息的这段字符串。废话不多说，上 OD，附加进程调试，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1ecqJLZfpK1RjSZFO7616nFXae.png" alt=""></p><p>附加后，我们需要来到主模块，点击 OD 上方的 <code>e</code> 按钮，点击第一个，这里需要重复操作两次才到主模块，完成上述操作后，我们先来看下程序主模块导入了哪些函数，<code>右键 -&gt; 查找 -&gt; 当前模块中的名称（标签）</code>，或者按下快捷键 <kbd>Ctrl</kbd> + <kbd>N</kbd>，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1b2qAL3HqK1RjSZFP763wapXar.png" alt=""></p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1eECCL3HqK1RjSZFE763GMXXaq.png" alt=""></p><p>在上面图中可以看出 <code>010 Editor</code> 调用了大量的 Qt 库函数，由此可猜测它是由 Qt 编写的，对于 Qt 中创建窗口函数，个人觉得，不管是何种高级语言，在底层中还是得调用诸如 <code>CreateWindow、MessageBox</code> 以及一些 <code>Dialog</code> 相关的函数，这些函数位于 <code>User32.dll</code> 中，同样点击 OD 上方的小 <code>e</code> 按钮，在里面找到 <code>user32.dll</code>，双击进去，在这里要说一点就是，创建窗口的 API 函数不止一个，而且也不存在 <code>CreateWindow、MessageBox</code> 这类函数，其实它们只是个宏，在深入一点都是调用 <code>Ex</code> 的版本，那么问题又来了，是调用 <code>A 版</code> 还是调用 <code>W 版</code> 的，学过 windows 编程的都知道，<code>A 版</code> 的最终还是会去调用 <code>W 版</code> 的， 所以我们不妨先对 <code>CreateWindowExW</code> 函数下断，按 <kbd>Ctrl</kbd> + <kbd>G</kbd>，输入 <code>CreateWindowExW</code>，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1W11DL7PoK1RjSZKb7601IXXa3.png" alt=""></p><p>转到这里后，对该地址下断，回到 <code>010 Editor</code> 注册界面，点击 <code>Check Lincense</code>，之后你会发现程序断下来了，这说明断点下对了，程序停在了 <code>0x74892480</code> 地址处。断下来之后，我们接下来要想的是哪里调用了这个函数，我们可以上方的 <code>k</code> 小按钮来查看，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1om1DLZbpK1RjSZFy760_qFXas.png" alt=""></p><p>通过栈回溯分析，可以看出，在地址 <code>0x00EFCD24</code> 上的函数过程有个很显眼的字 <code>show</code>，貌似跟显示窗口有关，我们双击进去看下里面有什么可以利用的信息，结果没发现有价值的东西，不要慌，我们继续点击上面这个地址的下一个地址，双击进行查看，结果也没有，再跟进去下一个地址，也就是 <code>0x00EFCDFC</code> 处，双击进去，会发现如下这种情况：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB17deAL8LoK1RjSZFu760n0XXa1.png" alt=""></p><p>通过上图可以看出，在这里面出现了大量可疑的字符串，其中 <code>Invalid name or password......</code> 这个字符串就是我们随意输入用户名和密码时弹出的信息提示，该处为一个 <code>push</code> 指令，我们向上看会发现该处是由 <code>0x1DE8489</code> 处跳转过来的，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1S_5PLZfpK1RjSZFO7616nFXaO.png" alt=""></p><p>不妨在 <code>0x1DE8489</code> 处下断点，把之前的断点禁用或者删除，回到注册界面，点击 <code>Check License</code>，会发现在该处断下来了，F8 一下就跳到无效密码处，在该 JNZ 指令上有三组 CMP 指令，并且第一组 CMP 指令是从地址 <code>0x01DE8336</code> 处跳转过来的，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1Qzq1L7voK1RjSZFw763iCFXaI.png" alt=""></p><p>我们来到第一组 CMP 指令源跳转处，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1zrzgL4jaK1RjSZKz760VwXXaH.png" alt=""></p><p>我们不妨在上面处下个断，重新回到注册界面，点击 <code>Check License</code>，会发现它会断在刚下的这个断点处，按 F8 下去，你会发现有两个关键的地方，一个是 <code>EDI</code> 的值，一个是 <code>EBX</code> 的值，前者需要和 <code>0xDB</code> 这个值作比较，后者则需要跟 <code>0xE7</code> 这个值作比较，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1mRr0MwTqK1RjSZPh760fOFXar.png" alt=""></p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1boL9MpzqK1RjSZFo762fcXXam.png" alt=""></p><p>这些值都是来自于 <code>EAX</code> 的赋值，而我们知道，<code>EAX</code> 寄存器存放的是函数的返回值，所以我们需要跟进函数里头去看下返回值是如何返回的，但现不急着跟进去，因为现在是暴力破解它，所以我们只需将地址 <code>0x019D8336</code> 处的 JNZ 指令给 NOP 掉即可，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB14ZvHMIfpK1RjSZFO7616nFXaT.png" alt=""></p><p>最后保存文件即可，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1MM2pMSrqK1RjSZK9760yypXaL.png" alt=""></p><p>双击运行 Dump 出来的文件，点击 <code>Check License</code> 会发现弹出如下提示：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>点击 <code>OK</code> 就可以进入到主界面了，这样就达到了暴力破解的目的了，但是这种方法对于这个软件来说有一点不好的地方的就是每次运行都会弹出这个注册界面，需再次点击 <code>Check License</code>，这样才能够使用。我们能不能双击直接进入呢？答案肯定能，我们重新理一下整个过程，如下：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>如果 EBX 为 0xE7 则跳，跳过之后，再对 EDI 比较，此时 EDI 为 0x177，0x177 不等于 0xDB 又跳走，接着有两次对 EDI 进行比较，值分别为 0xED 和 0x20C，我们知道，EDI 值为 0x177，所以两处的 JE 指令不成立，最后对比 EBX 的值，用它跟 0x93 对比，很明显 0xE7 不等于 0x93，所以 JNZ 指令成立，将跳过密码已被接受过程。</p><p>所以为了一开始不跳，<code>EBX</code> 的值要不为 <code>0xE7</code>，<code>EDI</code> 的值要为 <code>0xDB</code>，在上面谈到的两个重要的 CALL 里，第二个 CALL 是根据第一个 CALL 的最终 <code>EAX</code> 的来进行对 <code>EDI</code> 进行赋值，所以，为了让 <code>EDI</code> 的值为 <code>0xDB</code>，<code>EBX</code> 的值要为 <code>0x2D</code>，也就是说第一个 CALL 的最终 <code>EAX</code> 值要为 <code>0x2D</code>，我们可以跟进第一个 CALL 内，在最开头部分写下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov eax,0x2D</span><br></pre></td></tr></table></figure><p>如下：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>修改完后，会发现下一条指令的 <code>OPCODE</code> 下有一根下划线，这说明需要重定位，下次再运行时可能就不是这个地址了，所以我们需要做的就是把软件的重定位标志置为 0 保存即可，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1_W_QMMHqK1RjSZFE763GMXXaO.png" alt=""></p><p>重新运行 OD，将其载入，在最开头部分写下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov eax,0x2D</span><br><span class="line">retn 0x8</span><br></pre></td></tr></table></figure><p>如下所示：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1p9fSMQPoK1RjSZKb7601IXXaE.png" alt=""></p><p>最后 Dump 出来，双击运行下看是否成功，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1t6LGMMDqK1RjSZSy761xEVXaY.png" alt=""></p><p>由此可见，我们已成功完美破解了 <code>010 Editor</code> 了，尽情享用吧！</p><h2 id="初步分析算法"><a href="#初步分析算法" class="headerlink" title="初步分析算法"></a>初步分析算法</h2><p>在这小节当中，会对 <code>010 Editor</code> 注册算法进行详细分析。回顾上一小节，我们只是修改了一个跳转，但关键点还是在于那两个重要的 CALL，尤其是第一个 CALL，必须让它返回 <code>0x2D</code> 才是正确的，所以本小节将会跟进第一个关键 CALL 内去分析注册算法。在跟进之前，我们先来看下这个 CALL 有哪些参数，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1UyOaM7voK1RjSZFw763iCFXan.png" alt=""></p><p>我们知道，<code>ECX</code> 传参为 this 指针，后面两个分别为 <code>0x4596</code> 和 <code>0xA</code>，传的参肯定和用户名和密码有关系，我们不妨跟进 <code>ECX</code> 地址所在处数据窗口，<code>ECX</code> 的值为 <code>0330B300</code>，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1dnx9M3HqK1RjSZFg7617JXXag.png" alt=""></p><p>从上图可知，这个 this 指针应该是指向一个字符串数组，接着我们需进入到地址 <code>0330B304</code> 处，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1WBOhM7voK1RjSZFw763iCFXa7.png" alt=""></p><p>在这里我们需要转化成 <code>Unicode 16 位</code> 查看，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1wIt8M8LoK1RjSZFu760n0XXap.png" alt=""></p><p>注意地址的对应，从上图可知，这个字符串就是我们输入的用户名 <code>fanfanblog.cn</code>，我们返回到 this 指针下的第二个地址处跟进到数据窗口看下，也是同样的操作，如下：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>同样地，注意地址的对应，在这一段为你输入的密码，也可叫做序列号。知道这些后，对后面分析有一定帮助。我们跟进去第一个重要 CALL 内，以下作了一个简单的分析：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1Dx1DM4jaK1RjSZKz760VwXXaL.png" alt=""></p><p>由上面分析知，<code>ECX</code> 存放的是 this 指针，而 this 指针指向的是一个字符串数组，这个数组存放着用户名和密码字符串，我已将说明标注在上图中。所以为什么说之前我们需要跟进 <code>ECX</code> 中的数据窗口去查看下这个地址里存放的是什么东西，那么在上图分析过程中起到一个辅助作用。</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1aDOcM9zqK1RjSZPx7634tVXav.png" alt=""></p><p>在检测用户名和密码是否为空后，紧接着将一个局部变量的值压和栈中，右键栈中的地址数据窗口跟随，会发现这个数据是你输入的密码字符串，而且为 16 进制，所以说 PUSH 指令下的这个 CALL，是将密码字符串转为 16 进制字节的数据。如果你不放心，可以多测试几下，这里把密码换成 <code>1234-5678-9009-8765-4321</code>，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1viCoM9zqK1RjSZFp761kSXXav.png" alt=""></p><p>我们接着分析，在接下来，程序会将字符串 <code>999</code> 压入栈中进行一番不知什么操作，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB13qMFM4jaK1RjSZKz760VwXXaZ.png" alt=""></p><p>这一段并没有对用户名和密码字符串进行操作，所以不去深究它也无太大影响，在逆向分析中，并不是每条都分析一遍你才能破解它，而是找到关键部分进行分析，这一小段为一个小循环，这个 CALL，根据提示，应该 Qt 中运算符重载，由于对 Qt 不是很熟悉，而且这小段并未对用户名和密码进行操作，所以跳过它往下继续分析。从循环开始，那就是真正的到达算法处，算法并不是很难，但是有一点绕，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1gBAgM9zqK1RjSZFH7623CpXaT.png" alt=""></p><p>在上图中，有几个关键点地方，第一个圈起来的，它会拿你输入的密码的第 4 组数据去和 <code>0x9C、0xAC、0xFC</code> 这三个数进行比较，如果不是这三个数中的其中一个，那么程序会将 <code>0xE7</code> 赋值给 <code>EAX</code>，而在前面一小节当中，<code>EAX</code> 的值不能为 <code>0XE7</code>，否则失败，所以我们令 JNZ 下方这条指令为新的 EIP，否则 JNZ 条件成立跳过去了，就不好分析了，最后我们可以肯定，密码有三个版本，这里只分析下 <code>0x9C</code> 这个版本。第二个关键点是第二个圈起来的地方，跟进这个 CALL 里，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1eP.cM6DpK1RjSZFr76178VXaU.png" alt=""></p><p>同样，代码也不复杂，主要是判断余数是否为 0，如果为 0，那么就返回商，如果不为 0，那么就返回 0。所以这么一整段下来，在对 <code>k[0]、k[1]、k[2]、k[3]、k[4]、k[5]、k[6]、k[7]</code> 在进行操作，而我们输入的密码有 10 组，OD 中并没看到对 <code>k[8]、k[9]</code> 进行处理，其实这里有个关子，那就是当你密码中第 4 组数据为 <code>0x9C</code>，那么生成的密码并没有 10 组，而是 8 组，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1Lz3EM3HqK1RjSZFk760.WFXa1.png" alt=""></p><p>但不管怎么说，在 <code>0x9C</code> 情况下对每组数据进行异或、相加、与等操作，我们不妨先建立下注册机模型，我这里用的是 MFC 进行编写，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1Uy6ZM9zqK1RjSZPc762TepXa1.png" alt=""></p><p>在 <code>Generate</code> 生成按钮添加单击事件，相关代码如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成密码</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CMy010EditorRegisterDlg::OnBnClickedButtonGenerate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 在此添加控件通知处理程序代码</span></span><br><span class="line">    m_edit_password.<span class="built_in">SetWindowText</span>(<span class="string">L&quot;&quot;</span>);</span><br><span class="line">    CString str;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line">    BYTE k[<span class="number">8</span>] = &#123; <span class="number">0x12</span>,<span class="number">0x34</span>,<span class="number">0x56</span>,<span class="number">0x9C</span>,<span class="number">0x90</span>,<span class="number">0x09</span>,<span class="number">0x87</span>,<span class="number">0x65</span> &#125;;</span><br><span class="line">    <span class="keyword">while</span> (TRUE)</span><br><span class="line">    &#123;</span><br><span class="line">        BYTE k0 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">        BYTE k6 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">        <span class="comment">// AL = (k[0]^k[6]^0x18 + 0x3D)^0xA7</span></span><br><span class="line">        BYTE AL = (k0 ^ k6 ^ <span class="number">0x18</span> + <span class="number">0x3D</span>) ^ <span class="number">0xA7</span>;</span><br><span class="line">        <span class="keyword">if</span> (AL &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            k[<span class="number">0</span>] = k0;</span><br><span class="line">            k[<span class="number">6</span>] = k6;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ESI = (0x100*(k[1]^k[7] &amp; 0xFF) + k[2]^k[5] &amp; 0xFF)&amp;0xFFFF</span></span><br><span class="line">    <span class="comment">// EAX = ((ESI^0x7892+0x4D30)^0x3421)&amp;0xFFFF / 0xB</span></span><br><span class="line">    <span class="comment">// 判断余数是否为0，为0返回商，不为0返回0</span></span><br><span class="line">    <span class="keyword">while</span> (TRUE)</span><br><span class="line">    &#123;</span><br><span class="line">        BYTE k1 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">        BYTE k7 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">        BYTE k2 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">        BYTE k5 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">	</span><br><span class="line">        DWORD ESI = (<span class="number">0x100</span> * (k1 ^ k7 &amp; <span class="number">0xFF</span>) + k2 ^ k5 &amp; <span class="number">0xFF</span>) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">        DWORD EAX = (((ESI ^ <span class="number">0x7892</span>) + <span class="number">0x4D30</span>) ^ <span class="number">0x3421</span>) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">        <span class="keyword">if</span> (EAX % <span class="number">0xB</span> == <span class="number">0</span> &amp;&amp; EAX / <span class="number">0xB</span> &lt;= <span class="number">0x3E8</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            k[<span class="number">1</span>] = k1;</span><br><span class="line">            k[<span class="number">7</span>] = k7;</span><br><span class="line">            k[<span class="number">2</span>] = k2;</span><br><span class="line">            k[<span class="number">5</span>] = k5;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    str.<span class="built_in">Format</span>(<span class="string">L&quot;%02x%02x-%02x%02x-%02x%02x-%02x%02x&quot;</span>, k[<span class="number">0</span>], k[<span class="number">1</span>], k[<span class="number">2</span>], k[<span class="number">3</span>], k[<span class="number">4</span>], k[<span class="number">5</span>], k[<span class="number">6</span>], k[<span class="number">7</span>]);</span><br><span class="line">    m_edit_password.<span class="built_in">SetWindowText</span>(str.<span class="built_in">MakeUpper</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上代码只是让你遇到那两个 JE 和一个 JA 跳转指令可以使它不成立，这个雏形生成的密码并没有与用户名进行关联，在下一小节当中会分析密码与用户名的之间的联系。</p><h2 id="深入分析算法"><a href="#深入分析算法" class="headerlink" title="深入分析算法"></a>深入分析算法</h2><p>在上一小节当中，通过穷举法来找出符合要求的密码。下面将会为大家分析下用户名和密码之间的关系。</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1o_VeNkvoK1RjSZFN763xMVXap.png" alt=""></p><p>咱继续，接下来这一小段将 <code>ECX</code> 与 <code>0x2</code> 进行对比，其实好像也没什么用，我们看 JMP 跳转后的指令，如下：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>这一段主要是将用户名的字符串转为 <code>ASCII</code> 版，在接下来的一个调用 CALL 后，<code>EAX</code> 中为用户名字符串地址，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1RVufae3tHKVjSZSg7604QFXau.png" alt=""></p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1jMFRNhnaK1RjSZFt762C2VXan.png" alt=""></p><p>在上图中的 <code>ds:[edi+0x1C]</code> 处其实是前面处理 <code>k[0] 和 k[6]</code> 那个 CALL 后的返回值（即 <code>AL</code> 的值），所以我们需要将代码中的</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (AL &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    k[<span class="number">0</span>] = k0;</span><br><span class="line">    k[<span class="number">6</span>] = k6;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>改为如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (AL &gt; <span class="number">0xA</span>)</span><br><span class="line">&#123;</span><br><span class="line">    k[<span class="number">0</span>] = k0;</span><br><span class="line">    k[<span class="number">6</span>] = k6;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来就是要做的就是那个对用户名处理的 CALL，通过分析知道，这个 CALL 的返回值类似于哈希值，我们需要得到这个值，回为这个值需要和 <code>k[4]、k[5]、k[6]、k[7]</code> 发生关系，我们不妨声明这样一个函数，用来处理 <code>ASCII</code> 码版的用户名字符串，这里有个取巧的办法，那就是利用 IDA，将 <code>010 Editor</code> 载入 IDA 中，我们需要先获取处理这个用户名字符串的 CALL 的地址，这个地址可以通过 OD 找到，找到之后，切换到 IDA，按 <code>g</code> 输入地址回车，再按下 <code>F5</code> 进行翻译，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1JdJwNgHqK1RjSZFg7617JXXaW.png" alt=""></p><p>大致浏览一下，并不是太复杂，其中用到了一个数组，也就是上图圈出来的，双击进去，如下：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>这里显示的比较乱，我们可把地址 <code>02EDD840</code> 转到 OD 里查看，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1leRBNa6qK1RjSZFm7600PFXaP.png" alt=""></p><p>利用 OD 的插件将这一段进行数据转换并以 C++ 形式复制出来，并将其命名为 <code>dwEncodeArray</code>，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1CMaQae3tHKVjSZSg7604QFXa8.png" alt=""></p><p>并将原来的代码做下调整，如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成密码</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CMy010EditorRegisterDlg::OnBnClickedButtonGenerate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">    <span class="comment">// 先判断用户名输入是否为空</span></span><br><span class="line">    <span class="keyword">if</span>(m_edit_name.<span class="built_in">GetWindowTextLength</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        m_edit_password.<span class="built_in">SetWindowText</span>(<span class="string">L&quot;&quot;</span>);</span><br><span class="line">        CString str;</span><br><span class="line">        <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line">        <span class="keyword">int</span> nRet = <span class="number">0x3E8</span>;</span><br><span class="line">        BYTE k[<span class="number">8</span>] = &#123; <span class="number">0x12</span>,<span class="number">0x34</span>,<span class="number">0x56</span>,<span class="number">0x9C</span>,<span class="number">0x90</span>,<span class="number">0x09</span>,<span class="number">0x87</span>,<span class="number">0x65</span> &#125;;</span><br><span class="line">        m_edit_name.<span class="built_in">GetWindowText</span>(str);</span><br><span class="line">        <span class="function">CStringA <span class="title">stra</span><span class="params">(str.GetBuffer(<span class="number">0</span>))</span></span>;</span><br><span class="line">        str.<span class="built_in">ReleaseBuffer</span>();</span><br><span class="line">        <span class="function">string <span class="title">st</span><span class="params">(stra.GetBuffer(<span class="number">0</span>))</span></span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span>* cs = st.<span class="built_in">c_str</span>();</span><br><span class="line">        <span class="comment">// 用户名进行加密</span></span><br><span class="line">        DWORD dwKey = <span class="built_in">EncodeUserName</span>(cs, <span class="number">1</span>, <span class="number">0</span>, nRet);</span><br><span class="line">        <span class="comment">// CMP k[4],RetValue&amp;0xFF</span></span><br><span class="line">        <span class="comment">// CMP k[5],RetValue&gt;&gt;8&amp;0xFF</span></span><br><span class="line">        <span class="comment">// CMP k[6],RetValue&gt;&gt;16&amp;0xFF</span></span><br><span class="line">        <span class="comment">// CMP k[7],RetValue&gt;&gt;24&amp;0xFF</span></span><br><span class="line">        k[<span class="number">4</span>] = dwKey &amp; <span class="number">0xFF</span>;</span><br><span class="line">        k[<span class="number">5</span>] = dwKey &gt;&gt; <span class="number">8</span> &amp; <span class="number">0xFF</span>;</span><br><span class="line">        k[<span class="number">6</span>] = dwKey &gt;&gt; <span class="number">16</span> &amp; <span class="number">0xFF</span>;</span><br><span class="line">        k[<span class="number">7</span>] = dwKey &gt;&gt; <span class="number">24</span> &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">while</span> (TRUE)</span><br><span class="line">        &#123;</span><br><span class="line">            BYTE k0 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">            BYTE k6 = k[<span class="number">6</span>];</span><br><span class="line">            <span class="comment">// AL = (k[0]^k[6]^0x18 + 0x3D)^0xA7</span></span><br><span class="line">            BYTE AL = (k0 ^ k6 ^ <span class="number">0x18</span> + <span class="number">0x3D</span>) ^ <span class="number">0xA7</span>;</span><br><span class="line">            <span class="keyword">if</span> (AL &gt; <span class="number">0xA</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                k[<span class="number">0</span>] = k0;</span><br><span class="line">                k[<span class="number">6</span>] = k6;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ESI = (0x100*(k[1]^k[7] &amp; 0xFF) + k[2]^k[5] &amp; 0xFF)&amp;0xFFFF</span></span><br><span class="line">        <span class="comment">// EAX = ((ESI^0x7892+0x4D30)^0x3421)&amp;0xFFFF / 0xB</span></span><br><span class="line">        <span class="comment">// 判断余数是否为0，为0返回商，不为0返回0</span></span><br><span class="line">        <span class="keyword">while</span> (TRUE)</span><br><span class="line">        &#123;</span><br><span class="line">            BYTE k1 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">            BYTE k7 = k[<span class="number">7</span>];</span><br><span class="line">            BYTE k2 = <span class="built_in">rand</span>() % <span class="number">0xFF</span>;</span><br><span class="line">            BYTE k5 = k[<span class="number">5</span>];</span><br><span class="line">            DWORD ESI = (<span class="number">0x100</span> * (k1 ^ k7 &amp; <span class="number">0xFF</span>) + k2 ^ k5 &amp; <span class="number">0xFF</span>) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">            DWORD EAX = (((ESI ^ <span class="number">0x7892</span>) + <span class="number">0x4D30</span>) ^ <span class="number">0x3421</span>) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">            <span class="keyword">if</span> (EAX % <span class="number">0xB</span> == <span class="number">0</span> &amp;&amp; EAX / <span class="number">0xB</span> == <span class="number">0x3E8</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                k[<span class="number">1</span>] = k1;</span><br><span class="line">                k[<span class="number">7</span>] = k7;</span><br><span class="line">                k[<span class="number">2</span>] = k2;</span><br><span class="line">                k[<span class="number">5</span>] = k5;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">        str.<span class="built_in">Format</span>(<span class="string">L&quot;%02x%02x-%02x%02x-%02x%02x-%02x%02x&quot;</span>, k[<span class="number">0</span>], k[<span class="number">1</span>], k[<span class="number">2</span>], k[<span class="number">3</span>], k[<span class="number">4</span>], k[<span class="number">5</span>], k[<span class="number">6</span>], k[<span class="number">7</span>]);</span><br><span class="line">        m_edit_password.<span class="built_in">SetWindowText</span>(str.<span class="built_in">MakeUpper</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">MessageBox</span>(<span class="string">L&quot;Please enter name&quot;</span>, <span class="string">L&quot;warning&quot;</span>, MB_OK);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>EncodeUserName</code> 函数如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">CMy010EditorRegisterDlg::EncodeUserName</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">char</span> a3, <span class="keyword">unsigned</span> __int16 a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *v4; <span class="comment">// edx</span></span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// esi</span></span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// edi</span></span><br><span class="line">    <span class="keyword">unsigned</span> __int8 v7; <span class="comment">// bl</span></span><br><span class="line">    <span class="keyword">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">    <span class="keyword">int</span> v9; <span class="comment">// ecx</span></span><br><span class="line">    <span class="keyword">int</span> v10; <span class="comment">// ecx</span></span><br><span class="line">    <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">    <span class="keyword">unsigned</span> __int8 v12; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">    <span class="keyword">unsigned</span> __int8 v13; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">    <span class="keyword">unsigned</span> __int8 v14; <span class="comment">// [esp+10h] [ebp-8h]</span></span><br><span class="line">    <span class="keyword">int</span> v15; <span class="comment">// [esp+14h] [ebp-4h]</span></span><br><span class="line">    v4 = a1;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    v5 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (v5 &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    v13 = <span class="number">0</span>;</span><br><span class="line">    v7 = <span class="number">15</span> * a4;</span><br><span class="line">    v14 = <span class="number">17</span> * a3;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        v8 = <span class="built_in">toupper</span>((<span class="keyword">unsigned</span> __int8)v4[v6]);</span><br><span class="line">        v9 = v15 + dwEcodeArray[v8];</span><br><span class="line">        <span class="keyword">if</span> (a2)</span><br><span class="line">            v10 = dwEcodeArray[v13]</span><br><span class="line">            + dwEcodeArray[v7]</span><br><span class="line">            + dwEcodeArray[v14]</span><br><span class="line">            + dwEcodeArray[(<span class="keyword">unsigned</span> __int8)(v8 + <span class="number">47</span>)] * (dwEcodeArray[(<span class="keyword">unsigned</span> __int8)(v8 + <span class="number">13</span>)] ^ v9);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v10 = dwEcodeArray[v12]</span><br><span class="line">            + dwEcodeArray[v7]</span><br><span class="line">            + dwEcodeArray[v14]</span><br><span class="line">            + dwEcodeArray[(<span class="keyword">unsigned</span> __int8)(v8 + <span class="number">23</span>)] * (dwEcodeArray[(<span class="keyword">unsigned</span> __int8)(v8 + <span class="number">63</span>)] ^ v9);</span><br><span class="line">        result = v10;</span><br><span class="line">        v15 = v10;</span><br><span class="line">        v13 += <span class="number">19</span>;</span><br><span class="line">        ++v6;</span><br><span class="line">        v14 += <span class="number">9</span>;</span><br><span class="line">        v7 += <span class="number">13</span>;</span><br><span class="line">        v12 += <span class="number">7</span>;</span><br><span class="line">        v4 = a1;</span><br><span class="line">    &#125; <span class="keyword">while</span> (v6 &lt; v5);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译运行后如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB146JTNkvoK1RjSZFN763xMVXaA.png" alt=""></p><p>这样就达到了任意用户名注册！</p><h2 id="去除网络验证"><a href="#去除网络验证" class="headerlink" title="去除网络验证"></a>去除网络验证</h2><p>已加去除网络验证这一小节，今天在打开 <code>010 Editor</code> 时，发现它弹出如下界面：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1d4CJNpzqK1RjSZFv763B7VXao.png" alt=""></p><p>出现这种情况是 <code>010 Editor</code> 会把该密码上传到它的服务器，如果发现不是通过正常渠道获取得的密码，它会把这个密码拉黑，出现上述这种情况你也不要慌，接下来我会为大家分析怎么来去除网络验证。</p><p>打开 OD，把 <code>010 Editor</code> 拖进来，<code>F9</code> 运行起来，点击 <code>Check License</code>，会断在如下地方：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1nVWCNrPpK1RjSZFF7615PpXas.png" alt=""></p><p>因为之前下的断点我并没删除，<code>F8</code> 来到 <code>00E08229</code> 处，如果按照正常来说，在调用完这两个 CALL 后，<code>EAX</code> 中的值要为 <code>0xDB</code>，而此时变成了 <code>0x113</code>，第一个 CALL 调用后，<code>EAX</code> 的值为 <code>0x2D</code>，这个没问题，那么问题可能出现在第二个 CALL 内，这个 CALL 本应该把 <code>EAX</code> 的值修改为 <code>0xDB</code>，而它去却把它修改成了 <code>0x113</code>，我们不妨跟进这个 CALL 内，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB15hW9NxjaK1RjSZKz760VwXXa6.png" alt=""></p><p><code>F8</code> 运行到此处后，发现此处的 JE 指令跳转不成功，接下来的 <code>mov eax,0x113</code> 代码将被执行并返回，所以需将 JE 指令改为 JMP，改完之后，该 CALL 最后返回 <code>0xDB</code>，而不是 <code>0x113</code>，在后面你会发现即使修改了这处，它还是一样会验证失败，原因如下：</p><div class="tip"><p>提示：由于此文写的比较早，当时上传的图是使用免费图床，官方会不时清理免费用户的图，所以导致缺失。</p></div><p>这个 JNS 指令它会跳到失败处，也就是那个字符串提示你的密码已被删除，注意图中的 <code>EAX</code> 的值，它为 -1，同时，在运行 <code>00E0824B</code> 的 CALL 指令会卡一下，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB1vGCQNq6qK1RjSZFm7600PFXa0.png" alt=""></p><p>整个注册界面会变灰，这时它在调用这个 CALL 进行网络验证，需要等待一下，等它验证完后，<code>EAX</code> 的值变会变成 -1，从而使得 JNS 指令成立，所以解决的办法是进入到网络验证这个 CALL 内，把 <code>EAX</code> 的值修改成不是负数，在这我把它改成 1，如下：</p><p><img src="https://image.zeronohacker.com/article/2019/05/28/HTB190G2NxYaK1RjSZFn76180pXa7.png" alt=""></p><p><code>ret</code> 多少，可以向下滑，看它正常 <code>ret</code> 多少，你这里也 <code>ret</code> 多少，最后 Dump 出来覆盖原文件就可以了，注册机还是不变，只要你从官网下载 32 位版的 <code>010 Editor</code> 并安装在你计算机后，运行注册机后注册即可，以后就不用担心拉黑了。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined">zeronohacker</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://zeronohacker.github.io/2019/05/28/reverse-analysis-of-business-software-010-editor-and-registration-machine-writing/">https://zeronohacker.github.io/2019/05/28/reverse-analysis-of-business-software-010-editor-and-registration-machine-writing/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zeronohacker.github.io" target="_blank">zeronohacker</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/010-Editor/">010 Editor</a><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3/">逆向破解</a></div><div class="post_share"><div class="social-share" data-image="https://image.zeronohacker.com/top_img/2019/05/28/HTB1m_KwL9zqK1RjSZFj762lCFXaL.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/04/05/solve-the-problem-that-windbg-cannot-pop-up-when-virtualkd-and-windbg-debugs-win10/"><img class="prev-cover" src="https://image.zeronohacker.com/top_img/2020/04/05/header.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">解决 VirtualKD + Windbg 调试 win10 时无法弹出 Windbg 问题</div></div></a></div><div class="next-post pull-right"><a href="/2018/12/25/manually-build-the-block-table-of-the-pe-parser/"><img class="next-cover" src="https://image.zeronohacker.com/top_img/2018/12/25/maxresdefault.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">手工打造 PE 解析器之区块表</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://image.zeronohacker.com/header.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">zeronohacker</div><div class="author-info__description">There is no absolutely safe system in the world!</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zeronohacker"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://twitter.com/zeronohacker" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a><a class="social-icon" href="mailto:zeronohacker@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://zeronohacker.github.io/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#010-Editor-%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">010 Editor 简单介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90%E7%AE%97%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">初步分析算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%E7%AE%97%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">深入分析算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E7%BD%91%E7%BB%9C%E9%AA%8C%E8%AF%81"><span class="toc-number">4.</span> <span class="toc-text">去除网络验证</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/09/21/template-driven-av-and-edr-evasion-framework/" title="以模板驱动的逃避 AV/EDR 框架"><img src="https://image.zeronohacker.com/top_img/2021/09/21/inceptor-logo.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="以模板驱动的逃避 AV/EDR 框架"></a><div class="content"><a class="title" href="/2021/09/21/template-driven-av-and-edr-evasion-framework/" title="以模板驱动的逃避 AV/EDR 框架">以模板驱动的逃避 AV/EDR 框架</a><time datetime="2021-09-21T09:44:22.000Z" title="发表于 2021-09-21 17:44:22">2021-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/13/wmi-registry-part-3/" title="WMI 攻击手法研究 - 与 Windows 注册表交互 (第三部分)"><img src="https://image.zeronohacker.com/top_img/2021/09/13/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="WMI 攻击手法研究 - 与 Windows 注册表交互 (第三部分)"></a><div class="content"><a class="title" href="/2021/09/13/wmi-registry-part-3/" title="WMI 攻击手法研究 - 与 Windows 注册表交互 (第三部分)">WMI 攻击手法研究 - 与 Windows 注册表交互 (第三部分)</a><time datetime="2021-09-13T14:46:41.000Z" title="发表于 2021-09-13 22:46:41">2021-09-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/07/wmi-classes-methods-part-2/" title="WMI 攻击手法研究 - 探索命名空间、类和方法 (第二部分)"><img src="https://image.zeronohacker.com/top_img/2021/09/07/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="WMI 攻击手法研究 - 探索命名空间、类和方法 (第二部分)"></a><div class="content"><a class="title" href="/2021/09/07/wmi-classes-methods-part-2/" title="WMI 攻击手法研究 - 探索命名空间、类和方法 (第二部分)">WMI 攻击手法研究 - 探索命名空间、类和方法 (第二部分)</a><time datetime="2021-09-07T14:35:33.000Z" title="发表于 2021-09-07 22:35:33">2021-09-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/31/wmi-basics-part-1/" title="WMI 攻击手法研究 - 基础篇 (第一部分)"><img src="https://image.zeronohacker.com/top_img/2021/08/31/cover.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="WMI 攻击手法研究 - 基础篇 (第一部分)"></a><div class="content"><a class="title" href="/2021/08/31/wmi-basics-part-1/" title="WMI 攻击手法研究 - 基础篇 (第一部分)">WMI 攻击手法研究 - 基础篇 (第一部分)</a><time datetime="2021-08-31T14:25:57.000Z" title="发表于 2021-08-31 22:25:57">2021-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/30/decoding-malious-powershell-activity-a-case-study/" title="从一个恶意活动中学习 PowerShell 解码"><img src="https://image.zeronohacker.com/top_img/2021/03/30/4-0.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="从一个恶意活动中学习 PowerShell 解码"></a><div class="content"><a class="title" href="/2021/03/30/decoding-malious-powershell-activity-a-case-study/" title="从一个恶意活动中学习 PowerShell 解码">从一个恶意活动中学习 PowerShell 解码</a><time datetime="2021-03-30T13:50:59.000Z" title="发表于 2021-03-30 21:50:59">2021-03-30</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://image.zeronohacker.com/top_img/2019/05/28/HTB1m_KwL9zqK1RjSZFj762lCFXaL.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By zeronohacker</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="https://image.zeronohacker.com/icp.png"><span>赣ICP备20006890号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><script>function loadValine(){function e(){new Valine(Object.assign({el:"#vcomment",appId:"5zJhxW3eLTeGMw49HFsbee5P-gzGzoHsz",appKey:"GSf2czvdDct9w1M2UBwkGQ94",placeholder:"Please leave your footprints",avatar:"monsterid",meta:"nick,mail,link".split(","),pageSize:"10",lang:"zh-CN",recordIP:!1,serverURLs:"",emojiCDN:"",emojiMaps:"",enableQQ:!1,path:window.location.pathname,requiredFields:["nick,mail"],visitor:!1},null))}"function"==typeof Valine?e():getScript("https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js").then(e)}{function loadOtherComment(){loadValine()}setTimeout(loadValine,0)}</script></div><script defer id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script>!function(t,a,n){a.ChatraID="g2jne7zk7acH93cer";var c=t.createElement("script");a[n]=a[n]||function(){(a[n].q=a[n].q||[]).push(arguments)},c.async=!0,c.src="https://call.chatra.io/chatra.js",t.head&&t.head.appendChild(c)}(document,window,"Chatra");var chatBtnHide,chatBtnShow,chatBtnFn=()=>{document.getElementById("chat_btn").addEventListener("click",(function(){Chatra("openChat")}))};chatBtnFn()</script><script async data-pjax src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script></body></html>